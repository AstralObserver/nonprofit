<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>{{ .Title }}</title>
    
    <!-- Self-hosted Fonts -->
    <link rel="stylesheet" href="{{ "/css/fonts.css" | relURL }}">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    {{ $style := resources.Get "css/main.css" | resources.Fingerprint }}
    <link rel="stylesheet" href="{{ $style.RelPermalink | relURL }}">

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">
    <link rel="shortcut icon" href="/icons/favicon.ico">
    <link rel="manifest" href="/icons/site.webmanifest">
    
    {{ block "styles" . }}{{ end }}
</head>
<body>
    {{ partial "header.html" . }}

    <div class="container mt-4">
        {{ block "main" . }}{{ end }}
    </div>
    {{ partial "footer.html" . }}

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>
    {{ block "scripts" . }}
        <!-- Fallback script loading for pages that don't define scripts block -->
        {{ $script := resources.Get "js/main.js" | resources.Fingerprint }}
        <script src="{{ $script.RelPermalink | relURL }}"></script>
    {{ end }}
    {{- if hugo.IsProduction -}}
    <script>
      window.va = window.va || function () { (window.va.q = window.va.q || []).push(arguments); };
    </script>
    <script defer src="/_vercel/insights/script.js"></script>
    {{- end -}}

    <!-- Ensure main.js loads in production -->
    {{ if not (.Scratch.Get "mainJsLoaded") }}
        {{ $script := resources.Get "js/main.js" | resources.Fingerprint }}
        <script src="{{ $script.RelPermalink | relURL }}"></script>
        {{ .Scratch.Set "mainJsLoaded" true }}
    {{ end }}
</body>
</html>
